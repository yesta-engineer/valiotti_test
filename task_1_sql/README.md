Реализовал историзацию изменений статусов (SCD Type 2) через добавление триггера и функции. 

При добавлении записи в основную таблицу stg_orders срабатывает триггер, который для каждой новой строки вызывает функцию scd2_order_status_update.

В функции реализован поиск предыдущего значения у order_id, и если таковой имеется - то его изменение и добавление новой записи в таблицу orders_history, которая поддерживает историчность SCD2.

Если новую таблицу создавать не нужно, то можно посмотреть историчность, запустив такой запрос:

SELECT 
    order_id,
    status,
    updated_at AS valid_from,
    LEAD(updated_at) OVER (
        PARTITION BY order_id 
        ORDER BY updated_at
    ) AS valid_to
FROM stg_orders