**В задании 1** реализовал историзацию изменений статусов через добавление триггера и функции, и сохранении в новую таблицу.

**В задании 2** применил шифрование e-mail адресов с помощью Fernet из библиотеки cryptography.
Файл разбивается на чанки (пробовал и 100000 и 10000 результат примерно одинаковый), каждый обрабатывается и сохраняется во временный файл, который потом записывается в S3 в по ссылке "protected/users_20240115.csv". Нужно только реализовать сохранение ключа для последующей дешифровки, при необходимости. 

Так же можно шифровать и сразу сохранять файл в S3 без промежуточного деления и записывания. На сервере 2 ядра 4Ghz 8Gb ram это заняло всего ~170 секунд против 70 с делением.